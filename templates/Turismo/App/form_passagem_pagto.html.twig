<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/png" href="{{ getEnv('CROSIERCORE_URL') }}/build/static/images/favicon.ico"/>

    <title>{{ page_title is defined and page_title != '' ? page_title ~ ' - Crosier' : 'Crosier' }} </title>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
    <script src="https://assets.pagar.me/checkout/1.1.0/checkout.js"></script>

    {% set compra = app.session.get('compra') %}
    {% set totais = compra.getTotais() %}

    <script>

        $(document).ready(function () {

            // inicia a inst√¢ncia do checkout
            var checkout = new PagarMeCheckout.Checkout({
                encryption_key: 'ek_test_PRZKk0lxBz2qE7boo7T1kqZnzdkKrL',
                success: function (data) {
                    window.location = '/app/tur/compra/pagto?result=OK&token=' + data.token + '&payment_method=' + data.payment_method
                },
                error: function (err) {
                    $.get('/app/tur/compra/pagto?result=ERR&msg=' + err?.message + '&type=' + err?.type);
                },
                close: function () {
                    window.location = '/app/tur/compra/resumo'
                }
            });

            checkout.open({
                amount: {{ totais.geral|number_format(2,'','') }},
                postbackUrl: '{{ postbackUrl }}',
                customerData: 'true',
                paymentMethods: 'credit_card',
                maxInstallments: 3,
                freeInstallments: 3,
                createToken: 'true',
                items: [{
                    id: '1',
                    title: 'VIACAO IAPO PASSAGENS',
                    unit_price: {{ totais.geral|number_format(2,'','') }},
                    quantity: 1,
                    tangible: 'false',
                }]
            });
        });
    </script>
</head>

<body class="app header-fixed sidebar-fixed aside-menu-fixed sidebar-lg-show">


<div class="container-sm mt-3" style="margin-bottom: 50px">

    <div class="row mt-3 mb-2">
        <div class="col-12 text-center">
            <a href="{{ url('tur_app_compra_ini') }}">
                <img class="card-img-top" src="{{ getEnv('CROSIER_LOGO') }}" style="max-width: 200px"
                     alt="Card image cap">
            </a>
        </div>
    </div>



</div>


</body>


<script src="{{ crosierAsset('bundles/fosjsrouting/js/router.min.js') }}"></script>
<script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/es6-promise/4.0.5/es6-promise.auto.min.js"></script>

</html>